<?xml version="1.0" encoding="UTF-8"?>
<pages:BaseContentPage xmlns="http://xamarin.com/schemas/2014/forms"
                       xmlns:converters="clr-namespace:Xamarin.CommunityToolkit.Converters;assembly=Xamarin.CommunityToolkit"
                       xmlns:effects="clr-namespace:Xamarin.CommunityToolkit.Effects;assembly=Xamarin.CommunityToolkit"
                       xmlns:resources="clr-namespace:MVP.Resources"
                       xmlns:mvp="clr-namespace:MVP"
                       xmlns:models="clr-namespace:MVP.Models"
                       xmlns:pages="clr-namespace:MVP.Pages"
                       xmlns:vm="clr-namespace:MVP.ViewModels"
                       xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                       x:Class="MVP.Pages.IntroPage"
                       x:DataType="vm:IntroViewModel"
                       x:TypeArguments="vm:IntroViewModel"
                       xmlns:sh="clr-namespace:Sharpnado.Shades;assembly=Sharpnado.Shadows"
                       xmlns:ff="clr-namespace:FFImageLoading.Svg.Forms;assembly=FFImageLoading.Svg.Forms">

    <pages:BaseContentPage.Resources>
        <x:Int32 x:Key="LastItemIndex">1</x:Int32>
    </pages:BaseContentPage.Resources>

    <mvp:AppFrame SecondaryButtonText="{x:Static resources:Translations.sign_in}"
                  ShadowOpacity="0"
                  ShowTabShadow="False"
                  ShowSecondaryButton="True"
                  x:Name="appFrame"
                  effects:SafeAreaEffect.SafeArea="false,true">
        <mvp:AppFrame.Content>
            <Grid RowDefinitions="*, 120, Auto">

                <CarouselView HorizontalScrollBarVisibility="Never"
                              IndicatorView="indicator"
                              IsBounceEnabled="False"
                              ItemsSource="{Binding OnboardingItems}"
                              Loop="False"
                              VerticalScrollBarVisibility="Never"
                              x:Name="carousel">
                    <CarouselView.ItemTemplate>
                        <DataTemplate x:DataType="models:OnboardingItem">
                            <Grid Padding="40"
                                  RowSpacing="12"
                                  RowDefinitions="Auto,Auto,*">

                                <Label Grid.Row="0"
                                       FontFamily="{StaticResource font_bold}"
                                       FontSize="{StaticResource fontsize_h1}"
                                       HorizontalTextAlignment="Center"
                                       Text="{Binding Title}"/>

                                <Label Grid.Row="1"
                                       HorizontalTextAlignment="Center"
                                       Text="{Binding Description}"/>

                            </Grid>
                        </DataTemplate>
                    </CarouselView.ItemTemplate>
                </CarouselView>

                <Label Grid.Row="1"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center"
                       InputTransparent="True"
                       IsVisible="{Binding Path=Position, Source={x:Reference carousel}, Converter={converters:NotEqualConverter}, ConverterParameter={StaticResource LastItemIndex}}"
                       Text="{x:Static resources:Translations.swipe_to_continue}"
                       VerticalOptions="Center"/>

                <sh:Shadows Style="{StaticResource shade_primary}" 
                            IsVisible="{Binding Path=Position, Source={x:Reference carousel}, Converter={converters:EqualConverter}, ConverterParameter={StaticResource LastItemIndex}}"
                            Grid.Row="1">
                    <Button Command="{Binding SignInAsDemoCommand}"
                            HorizontalOptions="CenterAndExpand"
                            Style="{StaticResource primary_button}"
                            Text="{x:Static resources:Translations.try_with_demo_account}"
                            VerticalOptions="Center"/>
                </sh:Shadows>

                <IndicatorView Grid.Row="2"
                               ItemsSource="{Binding OnboardingItems}"
                               x:Name="indicator"
                               Margin="0,0,0,24"/>
            </Grid>
        </mvp:AppFrame.Content>
    </mvp:AppFrame>
</pages:BaseContentPage>
